---
alwaysApply: true
---

# LINEミニアプリ開発 要件定義書（Railway対応版）

## 1. プロジェクト概要
Botarhythm Coffee Roaster において、顧客の「来店履歴」および「購入履歴」をLINEミニアプリ上で記録・閲覧できるようにし、リピート促進と履歴管理の効率化を図る。

## 2. 対象ユーザー
- 一般来店客（LINEログインを使う）
- 店舗スタッフ（顧客の代理入力を行う）

## 3. 主な機能要件

### 3.1 顧客向け機能
- LINEログイン（LIFF）
- 来店チェックイン（ワンタップ）
- 購入履歴の登録（商品・数量）
- 過去の履歴閲覧

### 3.2 スタッフ向け機能
- 顧客一覧・履歴の確認（管理UI）
- 顧客に代わって履歴を記録する入力機能

## 4. 非機能要件

| 項目           | 内容                                      |
|----------------|-------------------------------------------|
| データ保存先   | Notion API（顧客DB・履歴DB）              |
| 本人認証       | LINEログイン（UIDによる一意識別）         |
| デバイス対応   | モバイルファースト（iOS/Android）         |
| 使用環境       | Cursor（React + Tailwind）                |
| サーバー運用   | **Railway（クラウドPaaS）で本番・検証サーバーを常時公開** |
| 環境変数管理   | **Railwayのダッシュボードで設定。`.env.example`をリポジトリに含める** |
| 拡張予定       | 将来的に電話番号照合やSquare連携を検討   |

- 本番・検証用URLはRailwayのサブドメインまたはカスタムドメインを利用
- 開発時はローカル＋ngrok等も可だが、本番LINEミニアプリ連携はRailway前提

## 5. UI設計指針

- LINE公式アプリのUIトーンに寄せた構成
- リッチメニューと連携（Canvaで作成予定）
- 各画面は `/checkin`, `/purchase`, `/history` に分割
- ボタンはタップしやすく、最小限の操作で目的を達成できるよう設計

## 6. Notionデータ構成

### 顧客DB
- LINE UID
- 表示名
- 登録日

### 履歴DB
- 関連顧客ID（Relation）
- タイプ（来店／購入）
- 日時
- 商品名／数量／メモ

## 7. スケジュール目安

| フェーズ           | 内容                                       |
|--------------------|--------------------------------------------|
| 要件定義・UI設計   | このドキュメントとプロンプトを整備         |
| 初期実装           | LIFF認証・Notion接続・UIスケルトン構築     |
| MVP構築            | 来店登録／履歴入力／履歴閲覧               |
| テスト・公開       | 店舗導入 → 顧客にリッチメニュー経由で提供  |

## 8. 備考
- 店舗レジはSquareターミナルを使用（現段階では連携せず）
- LINE公式アカウントのリッチメニューはCanvaでデザイン
